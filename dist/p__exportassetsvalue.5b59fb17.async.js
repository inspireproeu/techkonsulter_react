(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"9ZZJ":function(e,t,a){"use strict";var o=a("q1tI"),n=a.n(o),r=a("Z3vd"),i=(a("g7mT"),a("9kvl")),c=function(e){var t=e.to,a=e.color,o=e.title;return n.a.createElement(r["a"],{variant:"contained",color:a,style:{verticalAlign:"bottom",background:"#ed6c02",color:"#FFFFFF"},onClick:function(){i["c"].push({pathname:"/".concat(t)})},className:"actionbutton"},n.a.createElement("span",{className:"indicator-label"},o))};t["a"]=c},W7ZX:function(e,t,a){"use strict";a.d(t,"c",(function(){return _})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return h}));var o=a("qLMh"),n=a("9og8"),r=a("oBTY"),i=a("EUZL"),c=a.n(i),l=a("wd/R"),d=a.n(l),s=a("6K47"),p=function(e,t){return Object.keys(e).filter((function(e){return t.includes(e)})).reduce((function(t,a){return t[a]=e[a],t}),{})};function u(e){Math.floor(e);var t=Math.floor(e%1*24),a=Math.floor(60*(e%1*24-t));return new Date(Date.UTC(0,0,e,t-17,a))}function m(e){var t=["project_id.partner.","project_id.client."],a=t.join("|");return e.replace(new RegExp("\\b("+a+")\\b","gi"),"").replace(/\s{2,}/g,"")}var _=function(e,t,a){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4?arguments[4]:void 0,r=t.map((function(e){return o?e.field:e.header_name})),i=[];i="clientassets"===n?0===e.getSelectedRows().length?e.rowModel.rowsToDisplay.map((function(e){return e.data})):e.getSelectedRows().map((function(e){return e})):e;var l=i.map((function(e){return p(e,r)})),d=c.a.utils.json_to_sheet(l,{header:r.filter((function(e){return Object.keys(l[0]).indexOf(e)>-1}))}),s=c.a.utils.book_new();c.a.utils.book_append_sheet(s,d,"Sheet1"),c.a.writeFile(s,a,{type:"file"})},f=function(e,t,a){var o=t.filter((function(e){return"match"!==e.field&&"id"!==e.field}));o=o.map((function(e){return e.field}));var n=e.map((function(e){return p(e,o)})),r=c.a.utils.json_to_sheet(n,{header:o.filter((function(e){return e}))}),i=c.a.utils.book_new();c.a.utils.book_append_sheet(i,r,"Sheet1"),c.a.writeFile(i,a,{type:"file"})},b=function(e,t,a,o,n){var i=e.columnModel.columnDefs.map((function(e){return e.field})),l=[];"Assets"===t&&(l=["project_id.partner.partner_org_no","project_id.warehouse","user_created.email","project_id.partner.partner_name","project_id.client.client_name","project_id.client.client_org_no","project_id.warehouse"]);var s=l.map((function(e){return{name:e,match:i.some((function(t){return t===e}))}})),_=s.filter((function(e){return 1==e.match})).map((function(e){return m(e.name)}));i=[].concat(Object(r["a"])(_),Object(r["a"])(i),Object(r["a"])(l));var f=[];f=a.length>0?a:0===e.getSelectedRows().length?e.rowModel.rowsToDisplay.map((function(e){return e.data})):e.getSelectedRows().map((function(e){return e})),f.forEach((function(e){var a,o,r,i,c;"Projects"===t&&(e.client_name=null!==(a=e.client)&&void 0!==a&&a.client_name?e.client.client_name:"",e.partner_name=null!==(o=e.partner)&&void 0!==o&&o.partner_name?null===(r=e.partner)||void 0===r?void 0:r.partner_name:"",e.date_created=e.date_created?d()(e.date_created).format("YYYY-MM-DD"):"",e.user_created=e.user_created?e.user_created.email:null,e.sales_ref=e.sales_ref?e.sales_ref.email:"",e.remarketing=null===e||void 0===e?void 0:e.remarketing,e.no_of_assets_1=e.no_of_assets_1?Number(e.no_of_assets_1):0,null!==e&&void 0!==e&&e.invoice_by_client&&null!==e&&void 0!==e&&e.invoice_rec_amount&&(e.invoice_rec_amount>0?e.difference=parseFloat(e.invoice_by_client)-parseFloat(e.invoice_rec_amount):e.difference=null),delete e.handling_comments,delete e.client,delete e.client_org_no,delete e.partner,delete e.partner_org_no,delete e.priority);"Projects-finance"===t&&(e.project_id=null!==(i=e.project_id)&&void 0!==i&&i.id?null===(c=e.project_id)||void 0===c?void 0:c.id:null);if("Assets"===t){var l,s,p,m,_,f,b,h,v,g,y,w,x,j;if(null!==(l=e.project_id_obj)&&void 0!==l&&l.id||(e.project_id_obj=e.project_id),e.project_id=null!==(s=e.project_id)&&void 0!==s&&s.id?null===(p=e.project_id)||void 0===p?void 0:p.id:null===(m=e.project_id_obj)||void 0===m?void 0:m.id,e.warehouse=null!==(_=e.project_id)&&void 0!==_&&_.warehouse?null===(f=e.project_id)||void 0===f?void 0:f.warehouse:null===(b=e.project_id_obj)||void 0===b?void 0:b.warehouse,e.client_name=null!==(h=e.project_id_obj)&&void 0!==h&&null!==(v=h.client)&&void 0!==v&&v.client_name?null===(g=e.project_id_obj)||void 0===g?void 0:g.client.client_name:"",e.partner_name=null!==(y=e.project_id_obj)&&void 0!==y&&null!==(w=y.partner)&&void 0!==w&&w.partner_name?null===(x=e.project_id_obj)||void 0===x||null===(j=x.partner)||void 0===j?void 0:j.partner_name:"",e.target_price=e.target_price?Number(e.target_price):"",e.asset_id=e.asset_id?Number(e.asset_id):0,e.date_created=e.date_created?d()(e.date_created).format("YYYY-MM-DD"):"",e.created_by=e.user_created?e.user_created.email:"",e.asset_type){var k=null,S=null!==e&&void 0!==e&&e.asset_type?e.asset_type.trim().toLowerCase():null;if(S){var O,C,E,L="";if(!e.form_factor||""===e.form_factor&&null===e.form_factor?L=n.filter((function(e){return e.Asset_Name.toLowerCase()===S&&(null===e.formfactor||""===e.formfactor)})):(k=e.form_factor.trim().toLowerCase(),L=n.filter((function(e){var t;return e.Asset_Name.toLowerCase()===S&&(null===(t=e.formfactor)||void 0===t?void 0:t.trim().toLowerCase())===k}))),(null===(O=L)||void 0===O?void 0:O.length)>0)e.sample_co2=(e.quantity||1)*Number(null===(C=L[0])||void 0===C?void 0:C.sampleco2)||"",e.sample_weight=((e.quantity||1)*Number(null===(E=L[0])||void 0===E?void 0:E.sample_weight)).toFixed(1)||""}}d()(u(e.date_nor)).isValid()?e.date_nor=null!==e&&void 0!==e&&e.date_nor?d()(null===e||void 0===e?void 0:e.date_nor).format("YYYY-MM-DD"):"":e.date_nor=d()(null===e||void 0===e?void 0:e.date_nor).format("YYYY-MM-DD"),null===e||void 0===e||!e.complaint_from_app||null!==e&&void 0!==e&&e.complaint||(e.complaint=null===e||void 0===e?void 0:e.complaint_from_app),e.complaint=e.complaint?e.complaint:"";var R=e.complaint_1?e.complaint_1:"";if(e.complaint_1=R?e.complaint+";"+R:"","NULL"===e.Part_No&&(e.Part_No=""),"NULL"===e.processor&&(e.processor=""),"NULL"===e.model&&(e.model=""),"NULL"===e.grade&&(e.grade=""),e.complaint_from_app&&(e.complaint_from_app=e.complaint_from_app.replace(/;/g," ")),e.complaint&&(e.complaint=e.complaint.replace(/;/g," ")),e.asset_type&&"COMPUTER"===e.asset_type.toUpperCase()){var N=null!==e&&void 0!==e&&e.complaint?e.complaint.toLowerCase():null,T=null!==e&&void 0!==e&&e.complaint_1?e.complaint_1.toLowerCase():null;(N&&N.includes("no ram")||T&&T.includes("no ram"))&&(e.memory="N/A")}if(e.graphic_card&&"CERTUS"===e.data_generated){var z,M=e.graphic_card,D=/\[([^\][]*)]/g,Y=[];while(z=D.exec(M))Y.push(z[1]);e.graphic_card=Y.toString()}if(e.battery&&e.complaint&&e.form_factor&&"laptop"===e.form_factor.toLowerCase()){var U,I=e.battery.split(":");null!==(U=I[1])&&void 0!==U&&U.includes("%")&&I.forEach((function(t){if(t.includes("%")){var a=t.split("%")[0]?Math.round(t.split("%")[0].trim()):null;a<50?(e.battery="def/low % battery",e.complaint=e.complaint.trim()+" def bat"):e.battery=""}}))}if(e.asset_type&&"COMPUTER"===e.asset_type.toUpperCase()){var F=["no hdd","hdd rem","hdd crash","hdd fail"],V=null!==e&&void 0!==e&&e.complaint?e.complaint.toLowerCase():null,A=null!==e&&void 0!==e&&e.complaint_1?e.complaint_1.toLowerCase():null,P=!1,B=!1;F.forEach((function(e){V&&V.includes(e)&&(P=!0),A&&A.includes(e)&&(B=!0)})),e.hdd&&"N/A"!==e.hdd&&!e.hdd.includes("/")&&(P||B)?e.hdd="N/A":e.hdd||!P&&!B||(e.hdd="N/A")}delete e.updated_by,delete e.complaint_from_app}if(e.costprice&&(!e.target_price||Number(e.target_price)<=0)&&"RESERVATION"!==e.status&&"SOLD"!==e.status){var W=e.costprice;e.target_price=Math.round(parseInt(W)+parseInt(W)/100*20)}"Partnumbers"===t&&(e.status=e.status&&"published"===e.status.toLowerCase()?"Approved":"Not approved")}));var b=f.map((function(e){return p(e,i)})),h=c.a.utils.json_to_sheet(b,{header:i.filter((function(e){return(null===b||void 0===b?void 0:b.length)>0?Object.keys(b[0]).indexOf(e)>-1:i}))}),v=c.a.utils.book_new();c.a.utils.book_append_sheet(v,h,"Sheet1"),c.a.writeFile(v,"".concat(t," ").concat(o?" - "+o:"","-").concat(d()().format("YY-MM-DD"),".xlsx"),{type:"file"})},h=function(){var e=Object(n["a"])(Object(o["a"])().mark((function e(t,a,n){var r,i,c,l;return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=new s["Workbook"],i=r.addWorksheet(n),c=[],l=[],t.map((function(e){var t=16;e&&(c.push({key:e,width:t}),l.push(e))})),i.getRow(1).values=l,i.columns=c,a.forEach((function(e,t){i.addRow(e)})),r.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(t),o=document.createElement("a");o.href=a,o.download=n+"-".concat(d()().format("YY-MM-DD"),".xlsx"),o.click(),window.URL.revokeObjectURL(a)}));case 9:case"end":return e.stop()}}),e)})));return function(t,a,o){return e.apply(this,arguments)}}()},Z3vd:function(e,t,a){"use strict";var o=a("Ff2n"),n=a("wx14"),r=a("q1tI"),i=a("iuhU"),c=a("H2TA"),l=a("ye/S"),d=a("VD++"),s=a("NqtD"),p=function(e){return{root:Object(n["a"])({},e.typography.button,{boxSizing:"border-box",minWidth:64,padding:"6px 16px",borderRadius:e.shape.borderRadius,color:e.palette.text.primary,transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),"&:hover":{textDecoration:"none",backgroundColor:Object(l["a"])(e.palette.text.primary,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"},"&$disabled":{backgroundColor:"transparent"}},"&$disabled":{color:e.palette.action.disabled}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},text:{padding:"6px 8px"},textPrimary:{color:e.palette.primary.main,"&:hover":{backgroundColor:Object(l["a"])(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},textSecondary:{color:e.palette.secondary.main,"&:hover":{backgroundColor:Object(l["a"])(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlined:{padding:"5px 15px",border:"1px solid ".concat("light"===e.palette.type?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)"),"&$disabled":{border:"1px solid ".concat(e.palette.action.disabledBackground)}},outlinedPrimary:{color:e.palette.primary.main,border:"1px solid ".concat(Object(l["a"])(e.palette.primary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.primary.main),backgroundColor:Object(l["a"])(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},outlinedSecondary:{color:e.palette.secondary.main,border:"1px solid ".concat(Object(l["a"])(e.palette.secondary.main,.5)),"&:hover":{border:"1px solid ".concat(e.palette.secondary.main),backgroundColor:Object(l["a"])(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"&$disabled":{border:"1px solid ".concat(e.palette.action.disabled)}},contained:{color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],boxShadow:e.shadows[2],"&:hover":{backgroundColor:e.palette.grey.A100,boxShadow:e.shadows[4],"@media (hover: none)":{boxShadow:e.shadows[2],backgroundColor:e.palette.grey[300]},"&$disabled":{backgroundColor:e.palette.action.disabledBackground}},"&$focusVisible":{boxShadow:e.shadows[6]},"&:active":{boxShadow:e.shadows[8]},"&$disabled":{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground}},containedPrimary:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},containedSecondary:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}},disableElevation:{boxShadow:"none","&:hover":{boxShadow:"none"},"&$focusVisible":{boxShadow:"none"},"&:active":{boxShadow:"none"},"&$disabled":{boxShadow:"none"}},focusVisible:{},disabled:{},colorInherit:{color:"inherit",borderColor:"currentColor"},textSizeSmall:{padding:"4px 5px",fontSize:e.typography.pxToRem(13)},textSizeLarge:{padding:"8px 11px",fontSize:e.typography.pxToRem(15)},outlinedSizeSmall:{padding:"3px 9px",fontSize:e.typography.pxToRem(13)},outlinedSizeLarge:{padding:"7px 21px",fontSize:e.typography.pxToRem(15)},containedSizeSmall:{padding:"4px 10px",fontSize:e.typography.pxToRem(13)},containedSizeLarge:{padding:"8px 22px",fontSize:e.typography.pxToRem(15)},sizeSmall:{},sizeLarge:{},fullWidth:{width:"100%"},startIcon:{display:"inherit",marginRight:8,marginLeft:-4,"&$iconSizeSmall":{marginLeft:-2}},endIcon:{display:"inherit",marginRight:-4,marginLeft:8,"&$iconSizeSmall":{marginRight:-2}},iconSizeSmall:{"& > *:first-child":{fontSize:18}},iconSizeMedium:{"& > *:first-child":{fontSize:20}},iconSizeLarge:{"& > *:first-child":{fontSize:22}}}},u=r["forwardRef"]((function(e,t){var a=e.children,c=e.classes,l=e.className,p=e.color,u=void 0===p?"default":p,m=e.component,_=void 0===m?"button":m,f=e.disabled,b=void 0!==f&&f,h=e.disableElevation,v=void 0!==h&&h,g=e.disableFocusRipple,y=void 0!==g&&g,w=e.endIcon,x=e.focusVisibleClassName,j=e.fullWidth,k=void 0!==j&&j,S=e.size,O=void 0===S?"medium":S,C=e.startIcon,E=e.type,L=void 0===E?"button":E,R=e.variant,N=void 0===R?"text":R,T=Object(o["a"])(e,["children","classes","className","color","component","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"]),z=C&&r["createElement"]("span",{className:Object(i["a"])(c.startIcon,c["iconSize".concat(Object(s["a"])(O))])},C),M=w&&r["createElement"]("span",{className:Object(i["a"])(c.endIcon,c["iconSize".concat(Object(s["a"])(O))])},w);return r["createElement"](d["a"],Object(n["a"])({className:Object(i["a"])(c.root,c[N],l,"inherit"===u?c.colorInherit:"default"!==u&&c["".concat(N).concat(Object(s["a"])(u))],"medium"!==O&&[c["".concat(N,"Size").concat(Object(s["a"])(O))],c["size".concat(Object(s["a"])(O))]],v&&c.disableElevation,b&&c.disabled,k&&c.fullWidth),component:_,disabled:b,focusRipple:!y,focusVisibleClassName:Object(i["a"])(c.focusVisible,x),ref:t,type:L},T),r["createElement"]("span",{className:c.label},z,a,M))}));t["a"]=Object(c["a"])(p,{name:"MuiButton"})(u)},"dF/Y":function(e,t,a){"use strict";var o=a("VTBJ"),n=a("q1tI"),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},i=r,c=a("6VBw"),l=function(e,t){return n["createElement"](c["a"],Object(o["a"])(Object(o["a"])({},e),{},{ref:t,icon:i}))};l.displayName="DownloadOutlined";t["a"]=n["forwardRef"](l)},g7mT:function(e,t,a){},mxUb:function(e,t,a){e.exports=a.p+"static/logo_dark.5fc7a31f.png"},mzXb:function(e,t,a){e.exports={container:"container___Ix_xR",header:"header___1m_BJ",mainContent:"mainContent___3pioJ",textContainer:"textContainer___OW-_R",loginContainer1HeaderText:"loginContainer1HeaderText___2Lcnj",loginContainer1Text:"loginContainer1Text___2Q-64",main:"main___UcwxD",formsection:"formsection___2l-th",registerformsection:"registerformsection___3KMWR",contentsection:"contentsection___36rfo",icon:"icon___1zqXB",other:"other___1VjGs",register:"register___2rTx1",mainmobile:"mainmobile___1ZQlk",registerpage:"registerpage___3tJAj",borderbutton:"borderbutton___3ZVoS",filledbutton:"filledbutton___3BhD6",previousbutton:"previousbutton___21e8o",formsectionheading:"formsectionheading___1LkGX",formsectionsubheading:"formsectionsubheading___2ksac",links:"links___CaL3g",contentsectionheading:"contentsectionheading___3aU51",contentsectiontext:"contentsectiontext___2-HHE",formsectiontext:"formsectiontext___1ootv",logo:"logo___3oG7g",iconprimary:"iconprimary___3cyQP",inputContainer4:"inputContainer4___1eOYl",welcomeText:"welcomeText___1f7Tx",buttonTypes:"buttonTypes___2bv9h",buttonProgress:"buttonProgress___1kiHY",headerLogoText:"headerLogoText___19md4",main1:"main1___XNR2H",logo_dark:"logo_dark___1_2lR"}},wU8W:function(e,t,a){"use strict";a.r(t);a("+L6B");var o=a("2/Rp"),n=(a("T2oS"),a("W9HT")),r=a("qLMh"),i=a("9og8"),c=a("tJVT"),l=a("q1tI"),d=a.n(l),s=a("9kvl"),p=a("+n12"),u=a("W7ZX"),m=a("wd/R"),_=a("mzXb"),f=a.n(_),b=a("ydnR"),h=a("dF/Y"),v=a("mxUb"),g=a.n(v),y=a("9ZZJ"),w=function(e){var t=Object(p["j"])(),a=Object(l["useState"])([]),s=Object(c["a"])(a,2),_=(s[0],s[1]),v=Object(l["useState"])(!1),w=Object(c["a"])(v,2),x=w[0],j=w[1],k=[{field:"type",header_name:"type"},{field:"part_no",header_name:"Part number"},{field:"Manufacturer",header_name:"manufacturer"},{field:"model",header_name:"model"},{field:"cpu",header_name:"cpu"},{field:"value",header_name:"Working unit from/to value \u20ac"},{field:"avg_value",header_name:"Working unit average value \u20ac"}],S=function(){var e=Object(i["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:j(!0),Object(p["g"])("".concat(b["b"].EXPORTASSETVALUES.url)).then((function(e){j(!1);var t=e.data;_(t),null!==t&&void 0!==t&&t.length&&Object(u["c"])(t,k,"Assetsvalue-".concat(m().format("YY-MM-DD"),".xlsx"))})).catch((function(e){throw e}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l["useEffect"])((function(){S()}),[]),d.a.createElement("div",null,d.a.createElement("div",{className:f.a.container},d.a.createElement("div",{className:[f.a.main1,!!t&&f.a.mainmobile].join(" ")},d.a.createElement("div",{className:f.a.formsection},d.a.createElement("div",{className:f.a.headerLogoText},d.a.createElement("a",{className:f.a.logo_dark},d.a.createElement("img",{src:g.a}))),x?d.a.createElement(d.a.Fragment,null,d.a.createElement(n["a"],{size:"1rem",className:f.a.buttonProgress})," ",d.a.createElement("span",{style:{fontSize:20}},"Please wait while download in progress")):d.a.createElement(d.a.Fragment,null,d.a.createElement("span",{style:{fontSize:20}},"If the download of Tech Konsulter asset values doesn't start automatically, click here"),d.a.createElement("br",null),d.a.createElement(y["a"],{to:"assets",color:"warning",title:"Go Back"}),d.a.createElement(o["a"],{className:f.a.buttonTypes,onClick:function(){return S()}},d.a.createElement(h["a"],null)," Download"))))))};t["default"]=Object(s["a"])((function(e){var t=e.login,a=e.loading;return{login:t,submitting:a.effects["login/login"]}}))(w)}}]);