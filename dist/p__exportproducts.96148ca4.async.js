(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[21],{W7ZX:function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return h}));var n=a("qLMh"),r=a("9og8"),o=a("oBTY"),i=a("EUZL"),d=a.n(i),l=a("wd/R"),c=a.n(l),_=a("6K47"),u=function(e,t){return Object.keys(e).filter((function(e){return t.includes(e)})).reduce((function(t,a){return t[a]=e[a],t}),{})};function s(e){Math.floor(e);var t=Math.floor(e%1*24),a=Math.floor(60*(e%1*24-t));return new Date(Date.UTC(0,0,e,t-17,a))}function p(e){var t=["project_id.partner.","project_id.client."],a=t.join("|");return e.replace(new RegExp("\\b("+a+")\\b","gi"),"").replace(/\s{2,}/g,"")}var m=function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4?arguments[4]:void 0,o=t.map((function(e){return n?e.field:e.header_name})),i=[];i="clientassets"===r?0===e.getSelectedRows().length?e.rowModel.rowsToDisplay.map((function(e){return e.data})):e.getSelectedRows().map((function(e){return e})):e;var l=i.map((function(e){return u(e,o)})),c=d.a.utils.json_to_sheet(l,{header:o.filter((function(e){return Object.keys(l[0]).indexOf(e)>-1}))}),_=d.a.utils.book_new();d.a.utils.book_append_sheet(_,c,"Sheet1"),d.a.writeFile(_,a,{type:"file"})},f=function(e,t,a){var n=t.filter((function(e){return"match"!==e.field&&"id"!==e.field}));n=n.map((function(e){return e.field}));var r=e.map((function(e){return u(e,n)})),o=d.a.utils.json_to_sheet(r,{header:n.filter((function(e){return e}))}),i=d.a.utils.book_new();d.a.utils.book_append_sheet(i,o,"Sheet1"),d.a.writeFile(i,a,{type:"file"})},b=function(e,t,a,n,r){var i=e.columnModel.columnDefs.map((function(e){return e.field})),l=[];"Assets"===t&&(l=["project_id.partner.partner_org_no","project_id.warehouse","user_created.email","project_id.partner.partner_name","project_id.client.client_name","project_id.client.client_org_no","project_id.warehouse"]);var _=l.map((function(e){return{name:e,match:i.some((function(t){return t===e}))}})),m=_.filter((function(e){return 1==e.match})).map((function(e){return p(e.name)}));i=[].concat(Object(o["a"])(m),Object(o["a"])(i),Object(o["a"])(l));var f=[];f=a.length>0?a:0===e.getSelectedRows().length?e.rowModel.rowsToDisplay.map((function(e){return e.data})):e.getSelectedRows().map((function(e){return e})),f.forEach((function(e){var a,n,o,i,d;"Projects"===t&&(e.client_name=null!==(a=e.client)&&void 0!==a&&a.client_name?e.client.client_name:"",e.partner_name=null!==(n=e.partner)&&void 0!==n&&n.partner_name?null===(o=e.partner)||void 0===o?void 0:o.partner_name:"",e.date_created=e.date_created?c()(e.date_created).format("YYYY-MM-DD"):"",e.user_created=e.user_created?e.user_created.email:null,e.sales_ref=e.sales_ref?e.sales_ref.email:"",e.remarketing=null===e||void 0===e?void 0:e.remarketing,e.no_of_assets_1=e.no_of_assets_1?Number(e.no_of_assets_1):0,null!==e&&void 0!==e&&e.invoice_by_client&&null!==e&&void 0!==e&&e.invoice_rec_amount&&(e.invoice_rec_amount>0?e.difference=parseFloat(e.invoice_by_client)-parseFloat(e.invoice_rec_amount):e.difference=null),delete e.handling_comments,delete e.client,delete e.client_org_no,delete e.partner,delete e.partner_org_no,delete e.priority);"Projects-finance"===t&&(e.project_id=null!==(i=e.project_id)&&void 0!==i&&i.id?null===(d=e.project_id)||void 0===d?void 0:d.id:null);if("Assets"===t){var l,_,u,p,m,f,b,h,v,y,g,w,j,k;if(null!==(l=e.project_id_obj)&&void 0!==l&&l.id||(e.project_id_obj=e.project_id),e.project_id=null!==(_=e.project_id)&&void 0!==_&&_.id?null===(u=e.project_id)||void 0===u?void 0:u.id:null===(p=e.project_id_obj)||void 0===p?void 0:p.id,e.warehouse=null!==(m=e.project_id)&&void 0!==m&&m.warehouse?null===(f=e.project_id)||void 0===f?void 0:f.warehouse:null===(b=e.project_id_obj)||void 0===b?void 0:b.warehouse,e.client_name=null!==(h=e.project_id_obj)&&void 0!==h&&null!==(v=h.client)&&void 0!==v&&v.client_name?null===(y=e.project_id_obj)||void 0===y?void 0:y.client.client_name:"",e.partner_name=null!==(g=e.project_id_obj)&&void 0!==g&&null!==(w=g.partner)&&void 0!==w&&w.partner_name?null===(j=e.project_id_obj)||void 0===j||null===(k=j.partner)||void 0===k?void 0:k.partner_name:"",e.target_price=e.target_price?Number(e.target_price):"",e.asset_id=e.asset_id?Number(e.asset_id):0,e.date_created=e.date_created?c()(e.date_created).format("YYYY-MM-DD"):"",e.created_by=e.user_created?e.user_created.email:"",e.asset_type){var x=null,O=null!==e&&void 0!==e&&e.asset_type?e.asset_type.trim().toLowerCase():null;if(O){var L,C,M,E="";if(!e.form_factor||""===e.form_factor&&null===e.form_factor?E=r.filter((function(e){return e.Asset_Name.toLowerCase()===O&&(null===e.formfactor||""===e.formfactor)})):(x=e.form_factor.trim().toLowerCase(),E=r.filter((function(e){var t;return e.Asset_Name.toLowerCase()===O&&(null===(t=e.formfactor)||void 0===t?void 0:t.trim().toLowerCase())===x}))),(null===(L=E)||void 0===L?void 0:L.length)>0)e.sample_co2=(e.quantity||1)*Number(null===(C=E[0])||void 0===C?void 0:C.sampleco2)||"",e.sample_weight=((e.quantity||1)*Number(null===(M=E[0])||void 0===M?void 0:M.sample_weight)).toFixed(1)||""}}c()(s(e.date_nor)).isValid()?e.date_nor=null!==e&&void 0!==e&&e.date_nor?c()(null===e||void 0===e?void 0:e.date_nor).format("YYYY-MM-DD"):"":e.date_nor=c()(null===e||void 0===e?void 0:e.date_nor).format("YYYY-MM-DD"),null===e||void 0===e||!e.complaint_from_app||null!==e&&void 0!==e&&e.complaint||(e.complaint=null===e||void 0===e?void 0:e.complaint_from_app),e.complaint=e.complaint?e.complaint:"";var T=e.complaint_1?e.complaint_1:"";if(e.complaint_1=T?e.complaint+";"+T:"","NULL"===e.Part_No&&(e.Part_No=""),"NULL"===e.processor&&(e.processor=""),"NULL"===e.model&&(e.model=""),"NULL"===e.grade&&(e.grade=""),e.complaint_from_app&&(e.complaint_from_app=e.complaint_from_app.replace(/;/g," ")),e.complaint&&(e.complaint=e.complaint.replace(/;/g," ")),e.asset_type&&"COMPUTER"===e.asset_type.toUpperCase()){var D=null!==e&&void 0!==e&&e.complaint?e.complaint.toLowerCase():null,N=null!==e&&void 0!==e&&e.complaint_1?e.complaint_1.toLowerCase():null;(D&&D.includes("no ram")||N&&N.includes("no ram"))&&(e.memory="N/A")}if(e.graphic_card&&"CERTUS"===e.data_generated){var R,Y=e.graphic_card,S=/\[([^\][]*)]/g,U=[];while(R=S.exec(Y))U.push(R[1]);e.graphic_card=U.toString()}if(e.battery&&e.complaint&&e.form_factor&&"laptop"===e.form_factor.toLowerCase()){var P,A=e.battery.split(":");null!==(P=A[1])&&void 0!==P&&P.includes("%")&&A.forEach((function(t){if(t.includes("%")){var a=t.split("%")[0]?Math.round(t.split("%")[0].trim()):null;a<50?(e.battery="def/low % battery",e.complaint=e.complaint.trim()+" def bat"):e.battery=""}}))}if(e.asset_type&&"COMPUTER"===e.asset_type.toUpperCase()){var F=["no hdd","hdd rem","hdd crash","hdd fail"],B=null!==e&&void 0!==e&&e.complaint?e.complaint.toLowerCase():null,I=null!==e&&void 0!==e&&e.complaint_1?e.complaint_1.toLowerCase():null,H=!1,V=!1;F.forEach((function(e){B&&B.includes(e)&&(H=!0),I&&I.includes(e)&&(V=!0)})),e.hdd&&"N/A"!==e.hdd&&!e.hdd.includes("/")&&(H||V)?e.hdd="N/A":e.hdd||!H&&!V||(e.hdd="N/A")}delete e.updated_by,delete e.complaint_from_app}if(e.costprice&&(!e.target_price||Number(e.target_price)<=0)&&"RESERVATION"!==e.status&&"SOLD"!==e.status){var q=e.costprice;e.target_price=Math.round(parseInt(q)+parseInt(q)/100*20)}"Partnumbers"===t&&(e.status=e.status&&"published"===e.status.toLowerCase()?"Approved":"Not approved")}));var b=f.map((function(e){return u(e,i)})),h=d.a.utils.json_to_sheet(b,{header:i.filter((function(e){return(null===b||void 0===b?void 0:b.length)>0?Object.keys(b[0]).indexOf(e)>-1:i}))}),v=d.a.utils.book_new();d.a.utils.book_append_sheet(v,h,"Sheet1"),d.a.writeFile(v,"".concat(t," ").concat(n?" - "+n:"","-").concat(c()().format("YY-MM-DD"),".xlsx"),{type:"file"})},h=function(){var e=Object(r["a"])(Object(n["a"])().mark((function e(t,a,r){var o,i,d,l;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:o=new _["Workbook"],i=o.addWorksheet(r),d=[],l=[],t.map((function(e){var t=16;e&&(d.push({key:e,width:t}),l.push(e))})),i.getRow(1).values=l,i.columns=d,a.forEach((function(e,t){i.addRow(e)})),o.xlsx.writeBuffer().then((function(e){var t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=r+"-".concat(c()().format("YY-MM-DD"),".xlsx"),n.click(),window.URL.revokeObjectURL(a)}));case 9:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}()},"dF/Y":function(e,t,a){"use strict";var n=a("VTBJ"),r=a("q1tI"),o={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M505.7 661a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V168c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"download",theme:"outlined"},i=o,d=a("6VBw"),l=function(e,t){return r["createElement"](d["a"],Object(n["a"])(Object(n["a"])({},e),{},{ref:t,icon:i}))};l.displayName="DownloadOutlined";t["a"]=r["forwardRef"](l)},mxUb:function(e,t,a){e.exports=a.p+"static/logo_dark.5fc7a31f.png"},mzXb:function(e,t,a){e.exports={container:"container___Ix_xR",header:"header___1m_BJ",mainContent:"mainContent___3pioJ",textContainer:"textContainer___OW-_R",loginContainer1HeaderText:"loginContainer1HeaderText___2Lcnj",loginContainer1Text:"loginContainer1Text___2Q-64",main:"main___UcwxD",formsection:"formsection___2l-th",registerformsection:"registerformsection___3KMWR",contentsection:"contentsection___36rfo",icon:"icon___1zqXB",other:"other___1VjGs",register:"register___2rTx1",mainmobile:"mainmobile___1ZQlk",registerpage:"registerpage___3tJAj",borderbutton:"borderbutton___3ZVoS",filledbutton:"filledbutton___3BhD6",previousbutton:"previousbutton___21e8o",formsectionheading:"formsectionheading___1LkGX",formsectionsubheading:"formsectionsubheading___2ksac",links:"links___CaL3g",contentsectionheading:"contentsectionheading___3aU51",contentsectiontext:"contentsectiontext___2-HHE",formsectiontext:"formsectiontext___1ootv",logo:"logo___3oG7g",iconprimary:"iconprimary___3cyQP",inputContainer4:"inputContainer4___1eOYl",welcomeText:"welcomeText___1f7Tx",buttonTypes:"buttonTypes___2bv9h",buttonProgress:"buttonProgress___1kiHY",headerLogoText:"headerLogoText___19md4",main1:"main1___XNR2H",logo_dark:"logo_dark___1_2lR"}},qtXd:function(e,t,a){"use strict";a.r(t);a("+L6B");var n=a("2/Rp"),r=(a("T2oS"),a("W9HT")),o=a("qLMh"),i=a("9og8"),d=a("tJVT"),l=a("q1tI"),c=a.n(l),_=a("9kvl"),u=a("+n12"),s=a("W7ZX"),p=a("wd/R"),m=a("mzXb"),f=a.n(m),b=a("ydnR"),h=a("dF/Y"),v=a("mxUb"),y=a.n(v),g=function(e){var t=Object(u["j"])(),a=Object(l["useState"])([]),_=Object(d["a"])(a,2),m=(_[0],_[1]),v=Object(l["useState"])(!1),g=Object(d["a"])(v,2),w=g[0],j=g[1],k=[{type:"text",field:"project_id",header_name:"Project ID",order_by_id:1,id:31,hide:!1,bulk_update:!0,editable:!0},{type:null,field:"asset_id",header_name:"Asset ID",order_by_id:2,id:3,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"asset_type",header_name:"Asset Type",order_by_id:3,id:4,hide:!1,bulk_update:!0,editable:!0},{type:null,field:"form_factor",header_name:"Form Factor",order_by_id:4,id:9,hide:!1,bulk_update:!0,editable:!0},{type:null,field:"part_no",header_name:"Part nr",order_by_id:5,id:40,hide:!1,bulk_update:!0,editable:!0},{type:"numericColumn",field:"quantity",header_name:"QTY",order_by_id:6,id:5,hide:!1,bulk_update:!0,editable:!0},{type:"text",field:"manufacturer",header_name:"Manufacturer",order_by_id:8,id:6,hide:!1,bulk_update:!0,editable:!0},{type:"text",field:"model",header_name:"Model",order_by_id:9,id:7,hide:!1,bulk_update:!0,editable:!0},{type:"text",field:"imei",header_name:"IMEI",order_by_id:11,id:2,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"serial_number",header_name:"Serial Number",order_by_id:12,id:20,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"processor",header_name:"Processor",order_by_id:13,id:10,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"memory",header_name:"Memory",order_by_id:14,id:11,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"hdd",header_name:"HDD",order_by_id:15,id:12,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"optical",header_name:"Optical",order_by_id:17,id:13,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"graphic_card",header_name:"Graphic Card",order_by_id:18,id:43,hide:!1,bulk_update:!0,editable:!0},{type:null,field:"battery",header_name:"Battery",order_by_id:19,id:17,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"keyboard",header_name:"Keyboard",order_by_id:20,id:18,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"screen",header_name:"Screen",order_by_id:21,id:14,hide:!1,bulk_update:!0,editable:!0},{type:null,field:"description",header_name:"Description",order_by_id:22,id:26,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"grade",header_name:"Grade",order_by_id:23,id:24,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"complaint",header_name:"Complaint",order_by_id:24,id:25,hide:!1,bulk_update:!1,editable:!0},{type:null,field:"target_price",header_name:"Target Price",order_by_id:25,id:38,hide:!1,bulk_update:!1,editable:!0}],x=function(){var e=Object(i["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:j(!0),Object(u["g"])("".concat(b["b"].EXPORTPRODUCTS.url)).then((function(e){var t;j(!1),m(e.data),null!==(t=e.data)&&void 0!==t&&t.length&&Object(s["c"])(e.data,k,"Assets-".concat(p().format("YY-MM-DD"),".xlsx"))})).catch((function(e){throw e}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(l["useEffect"])((function(){x()}),[]),c.a.createElement("div",null,c.a.createElement("div",{className:f.a.container},c.a.createElement("div",{className:[f.a.main1,!!t&&f.a.mainmobile].join(" ")},c.a.createElement("div",{className:f.a.formsection},c.a.createElement("div",{className:f.a.headerLogoText},c.a.createElement("a",{className:f.a.logo_dark},c.a.createElement("img",{src:y.a}))),w?c.a.createElement(c.a.Fragment,null,c.a.createElement(r["a"],{size:"1rem",className:f.a.buttonProgress})," ",c.a.createElement("span",{style:{fontSize:20}},"Please wait while download in progress")):c.a.createElement(c.a.Fragment,null,c.a.createElement("span",{style:{fontSize:20}},"If the download of Tech Konsulter stocklist doesn't start automatically, click here"),c.a.createElement("br",null),c.a.createElement(n["a"],{className:f.a.buttonTypes,onClick:function(){return x()}},c.a.createElement(h["a"],null)," Download"))))))};t["default"]=Object(_["a"])((function(e){var t=e.login,a=e.loading;return{login:t,submitting:a.effects["login/login"]}}))(g)}}]);